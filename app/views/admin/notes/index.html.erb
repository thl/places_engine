<%
if parent_type.to_s =~ /feature/
	add_breadcrumb_item features_link
end
# Notes are polymorphic,
# so we've gotta support
# breadcrumbs for each of the parent types!

if parent_type==:feature
	add_breadcrumb_item feature_link(@parent_object)
end

if parent_type==:feature_object_type
	# @parent_object is FeatureObjectType
	add_breadcrumb_item feature_link(@parent_object.feature)
	add_breadcrumb_item link_to('feature object types', admin_feature_feature_object_types_path(@parent_object.feature))
	add_breadcrumb_item link_to(@parent_object, admin_feature_object_type_path(@parent_object))
end

if parent_type==:feature_geo_code
	# @parent_object is FeatureGeoCode
	add_breadcrumb_item feature_link(@parent_object.feature)
	add_breadcrumb_item link_to('feature geo codes', admin_feature_feature_geo_codes_path(@parent_object.feature))
	add_breadcrumb_item link_to(@parent_object, admin_feature_geo_code_path(@parent_object))
end

if parent_type==:feature_name
	add_breadcrumb_item feature_link(@parent_object.feature)
	add_breadcrumb_item feature_names_link(@parent_object.feature)
	add_breadcrumb_item link_to(@parent_object.name, admin_feature_name_path(@parent_object))
end
if parent_type==:feature_relation
	add_breadcrumb_item feature_link(@parent_object.child_node)
	add_breadcrumb_item link_to('relations', admin_feature_feature_relations_path(@parent_object.child_node))
	add_breadcrumb_item feature_relation_role_label(@parent_object.child_node, @parent_object, :use_first=>false)
end
if parent_type==:feature_name_relation
	add_breadcrumb_item feature_link(@parent_object.child_node.feature)
	add_breadcrumb_item feature_names_link(@parent_object.child_node.feature)
	add_breadcrumb_item link_to(@parent_object.child_node.name, admin_feature_name_path(@parent_object.child_node))
	add_breadcrumb_item link_to('relations', admin_feature_name_feature_name_relations_path(@parent_object.child_node))
	add_breadcrumb_item link_to(@parent_object, admin_feature_name_feature_name_relation_path(@parent_object.child_node, @parent_object))
end
add_breadcrumb_item 'notes'
%>

<div>
	<div class="left">
	<%= resource_search_form %>
	</div>
	<div class="right highlight">
	<% if parent? %>
		<%= new_item_link [@parent_object, :note] %>
	<% else %>
		<%= parent_resource_dependency_message %>
	<% end %>
	</div>
</div>

<br class="clear"/>

<%= render :partial => 'list', :locals => { :list => @collection } %>
